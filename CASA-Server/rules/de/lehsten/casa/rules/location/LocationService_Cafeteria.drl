#created on: 19.09.2012
package de.lehsten.casa.rules.location

import de.lehsten.casa.contextserver.types.entities.place.Cafeteria;
import de.lehsten.casa.contextserver.types.entities.device.MobilePhone;

rule "LocationService_Cafeteria"
	when
		c : Cafeteria()
		m : MobilePhone( nearbyPlaces not contains c)
	then
		System.out.println("Cafeteria found");
		modify(m){
			addToNearbyPlaces(c);
		}
end
/*
rule "MensaMenu"
//	timer ( cron: 15 11   *   *  1-5 ? )
	when
		r : Request(userID != null)
		c : Cafeteria()
		m : MobilePhone( owner == r.userID && nearbyPlaces contains c)
//		p : MovementEvent( deviceID == m.deviceID) from entry-point "StudIPEntryPoint"
	then
		Website s = new Website();
		s.setTitle("Mensa Speiseplan heute");
		s.setTargetURL("http://www.studentenwerk-rostock.de/index.php?lang=de&mainmenue=4&submenue=47&type=details&detail1=1&detail2=5678");
		s.setSource("MensaMenu");
		r.addResult(s);
end	
*/

//TODO: DEBUG!!!
/*
rule "MensaMenu"
	timer ( cron: 15 11   *   *  1-5 ? )
	when
		m : MobilePhone()
		p : MovementEvent( deviceID == m.deviceID) from entry-point "StudIPEntryPoint"
	then
		System.out.println("Adding Mensa Menu");
		Website s = new Website();
		s.setTargetURL("http://www.studentenwerk-rostock.de/index.php?lang=de&mainmenue=4&submenue=47&type=details&detail1=1&detail2=5678");
		s.setSource("MensaMenuRule");
		insert(s);
end	
*/